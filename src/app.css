@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
	:root {
		--sidebar-width: 280px;
		--header-height: 64px;
	}

	body {
		@apply antialiased;
	}
}

@layer components {
	/* Dashboard grid layout */
	.dashboard-layout {
		display: grid;
		grid-template-columns: 1fr;
		grid-template-rows: var(--header-height) 1fr;
		height: 100dvh;
		overflow: hidden;
	}

	@media (min-width: 1024px) {
		.dashboard-layout {
			grid-template-columns: var(--sidebar-width) 1fr;
		}
	}

	.dashboard-header {
		grid-column: 1 / -1;
		@apply border-b border-slate-200 dark:border-slate-700;
	}

	.dashboard-sidebar {
		@apply overflow-y-auto border-r border-slate-200 dark:border-slate-700;
	}

	/* Mobile: sidebar is a fixed overlay drawer */
	@media (max-width: 1023px) {
		.dashboard-sidebar {
			position: fixed;
			top: var(--header-height);
			left: 0;
			bottom: 0;
			width: var(--sidebar-width);
			z-index: 40;
			transform: translateX(-100%);
			transition: transform 0.2s ease-in-out;
		}

		.dashboard-sidebar.mobile-open {
			transform: translateX(0);
		}
	}

	/* Desktop: sidebar is in-grid */
	@media (min-width: 1024px) {
		.dashboard-sidebar {
			grid-row: 2;
		}
	}

	.dashboard-main {
		grid-row: 2;
		@apply flex overflow-hidden;
	}

	/* Sidebar backdrop for mobile */
	.sidebar-backdrop {
		position: fixed;
		inset: 0;
		top: var(--header-height);
		z-index: 30;
		background-color: rgba(0, 0, 0, 0.5);
	}

	/* Panel system */
	.panel {
		@apply flex-1 overflow-y-auto border-r border-slate-200 dark:border-slate-700 last:border-r-0;
	}

	@media (min-width: 1024px) {
		.panel {
			min-width: 320px;
		}
	}

	.panel-resizer {
		@apply w-1 cursor-col-resize bg-slate-200 dark:bg-slate-700 hover:bg-blue-500 transition-colors;
	}

	/* Entity cards with type-specific accent colors */
	.entity-card {
		@apply rounded-lg border border-slate-200 dark:border-slate-700 p-4 transition-shadow hover:shadow-md bg-white dark:bg-surface-dark-secondary;
	}

	.entity-card[data-type='character'] {
		@apply border-l-4 border-l-character;
	}
	.entity-card[data-type='npc'] {
		@apply border-l-4 border-l-npc;
	}
	.entity-card[data-type='location'] {
		@apply border-l-4 border-l-location;
	}
	.entity-card[data-type='faction'] {
		@apply border-l-4 border-l-faction;
	}
	.entity-card[data-type='item'] {
		@apply border-l-4 border-l-item;
	}
	.entity-card[data-type='session'] {
		@apply border-l-4 border-l-session;
	}
	.entity-card[data-type='scene'] {
		@apply border-l-4 border-l-scene;
	}
	.entity-card[data-type='deity'] {
		@apply border-l-4 border-l-deity;
	}
	.entity-card[data-type='timeline_event'] {
		@apply border-l-4 border-l-timeline;
	}
	.entity-card[data-type='world_rule'] {
		@apply border-l-4 border-l-rule;
	}
	.entity-card[data-type='player_profile'] {
		@apply border-l-4 border-l-player;
	}
	.entity-card[data-type='campaign'] {
		@apply border-l-4 border-l-campaign;
	}

	/* Buttons */
	.btn {
		@apply inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none;
	}

	.btn-primary {
		@apply bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500;
	}

	.btn-secondary {
		@apply bg-slate-100 text-slate-900 hover:bg-slate-200 focus:ring-slate-500 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600;
	}

	.btn-ghost {
		@apply text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800;
	}

	/* Form inputs */
	.input {
		@apply w-full rounded-md border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-3 py-2 text-sm text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500;
	}

	.input-error {
		@apply border-red-500 dark:border-red-400 focus:border-red-500 focus:ring-red-500;
	}

	.label {
		@apply block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1;
	}

	.error-message {
		@apply text-sm text-red-500 dark:text-red-400 mt-1;
	}

	/* Search dropdown */
	.search-dropdown {
		@apply absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-800
			border border-slate-200 dark:border-slate-700 rounded-md shadow-lg
			max-h-96 overflow-y-auto z-50;
	}

	.search-type-group {
		@apply border-b border-slate-100 dark:border-slate-700 last:border-b-0;
	}

	.search-type-header {
		@apply px-3 py-1.5 text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase
			bg-slate-50 dark:bg-slate-900 flex items-center gap-2 sticky top-0;
	}

	.search-result-item {
		@apply w-full px-3 py-2 text-left flex flex-col gap-0.5 cursor-pointer
			hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors;
	}

	.search-result-item.selected {
		@apply bg-slate-100 dark:bg-slate-700;
	}

	/* Command palette items */
	.command-item {
		@apply w-full px-3 py-2 text-left flex items-center gap-3 cursor-pointer
			hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors;
	}

	.command-item.selected {
		@apply bg-slate-100 dark:bg-slate-700;
	}

	/* Drag and drop styles */
	.drag-handle {
		@apply cursor-grab active:cursor-grabbing min-w-[44px] min-h-[44px] flex items-center justify-center;
		touch-action: none;
	}

	/* Apply to dragging items via svelte-dnd-action */
	:global([aria-grabbed='true']) {
		@apply opacity-50 shadow-lg;
	}

	/* Drop zone indicator */
	:global(.dnd-dragging) {
		@apply transition-transform duration-200;
	}
}
